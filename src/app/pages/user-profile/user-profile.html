<!-- src/app/pages/profile/profile.component.html -->
<div class="profile-page">
  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-overlay">
    <div class="loading-content">
      <div class="spinner"></div>
      <p>Profil yÃ¼kleniyor...</p>
    </div>
  </div>

  <div class="container">
    <!-- Profile Header -->
    <div class="profile-header">
      <div class="header-content">
        <div class="avatar-section">
          <div class="avatar-large" (click)="changeAvatar()">
            <div class="avatar-initials">{{getUserInitials()}}</div>
            <div class="avatar-change">ğŸ“·</div>
          </div>
          <div class="avatar-info">
            <h1>{{user.name}}</h1>
            <p class="user-email">{{user.email}}</p>
            <div class="user-badges">
              <span class="badge" [class]="user.type === 'donor' ? 'badge-primary' : 'badge-success'">
                {{user.type === 'donor' ? 'BaÄŸÄ±ÅŸÃ§Ä±' : 'AlÄ±cÄ±'}}
              </span>
              <span class="badge" [class]="user.isVerified ? 'badge-success' : 'badge-warning'">
                {{user.isVerified ? 'âœ“ DoÄŸrulanmÄ±ÅŸ' : 'DoÄŸrulanmamÄ±ÅŸ'}}
              </span>
            </div>
          </div>
        </div>
        
        <div class="header-stats">
          <div class="stat">
            <div class="stat-number">{{stats.totalDonations}}</div>
            <div class="stat-label">BaÄŸÄ±ÅŸ</div>
          </div>
          <div class="stat">
            <div class="stat-number">{{stats.totalReceived}}</div>
            <div class="stat-label">AlÄ±nan</div>
          </div>
          <div class="stat">
            <div class="stat-number">{{stats.memberSince}}</div>
            <div class="stat-label">GÃ¼ndÃ¼r Ãœye</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Tabs Navigation -->
    <div class="profile-tabs">
      <div class="tabs-header">
        <button 
          class="tab-btn" 
          [class.active]="activeTab === 'personal'"
          (click)="setActiveTab('personal')">
          <span class="tab-icon">ğŸ‘¤</span>
          KiÅŸisel Bilgiler
        </button>
        <button 
          class="tab-btn" 
          [class.active]="activeTab === 'address'"
          (click)="setActiveTab('address')">
          <span class="tab-icon">ğŸ“</span>
          Adreslerim
        </button>
        <button 
          class="tab-btn" 
          [class.active]="activeTab === 'security'"
          (click)="setActiveTab('security')">
          <span class="tab-icon">ğŸ”’</span>
          GÃ¼venlik
        </button>
        <button 
          class="tab-btn" 
          [class.active]="activeTab === 'preferences'"
          (click)="setActiveTab('preferences')">
          <span class="tab-icon">âš™ï¸</span>
          Tercihler
        </button>
      </div>

      <!-- Tab Content -->
      <div class="tab-content">
        <!-- Personal Info Tab -->
        <div *ngIf="activeTab === 'personal'" class="tab-pane">
          <form (ngSubmit)="updatePersonalInfo()" #personalForm="ngForm">
            <div class="form-grid">
              <div class="form-group">
                <label for="firstName" class="form-label">Ad *</label>
                <input
                  type="text"
                  id="firstName"
                  class="form-control"
                  [(ngModel)]="personalInfo.firstName"
                  name="firstName"
                  required>
              </div>
              
              <div class="form-group">
                <label for="lastName" class="form-label">Soyad *</label>
                <input
                  type="text"
                  id="lastName"
                  class="form-control"
                  [(ngModel)]="personalInfo.lastName"
                  name="lastName"
                  required>
              </div>
              
              <div class="form-group">
                <label for="email" class="form-label">E-posta *</label>
                <input
                  type="email"
                  id="email"
                  class="form-control"
                  [(ngModel)]="personalInfo.email"
                  name="email"
                  required
                  email>
              </div>
              
              <div class="form-group">
                <label for="phone" class="form-label">Telefon</label>
                <input
                  type="tel"
                  id="phone"
                  class="form-control"
                  [(ngModel)]="personalInfo.phone"
                  name="phone"
                  placeholder="05XX XXX XX XX">
              </div>
              
              <div class="form-group">
                <label for="city" class="form-label">Åehir</label>
                <select
                  id="city"
                  class="form-control"
                  [(ngModel)]="personalInfo.city"
                  name="city">
                  <option value="">Åehir seÃ§in</option>
                  <option *ngFor="let city of cities" [value]="city">
                    {{city}}
                  </option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="birthDate" class="form-label">DoÄŸum Tarihi</label>
                <input
                  type="date"
                  id="birthDate"
                  class="form-control"
                  [(ngModel)]="personalInfo.birthDate"
                  name="birthDate">
              </div>
            </div>
            
            <div class="form-group">
              <label for="bio" class="form-label">HakkÄ±mda</label>
              <textarea
                id="bio"
                class="form-control"
                rows="4"
                [(ngModel)]="personalInfo.bio"
                name="bio"
                placeholder="Kendinizden bahsedin (isteÄŸe baÄŸlÄ±)..."
                maxlength="500"></textarea>
              <div class="char-count">{{personalInfo.bio.length || 0}} / 500</div>
            </div>
            
            <div class="form-actions">
              <button
                type="button"
                class="btn btn-outline"
                (click)="cancelPersonalInfo()">
                Ä°ptal
              </button>
              <button
                type="submit"
                class="btn btn-primary"
                [disabled]="isSaving || !personalForm.form.valid">
                <span *ngIf="!isSaving">DeÄŸiÅŸiklikleri Kaydet</span>
                <span *ngIf="isSaving">Kaydediliyor...</span>
              </button>
            </div>
          </form>
        </div>

        <!-- Address Tab -->
        <div *ngIf="activeTab === 'address'" class="tab-pane">
          <div class="address-header">
            <h3>Adreslerim</h3>
            <button class="btn btn-primary btn-sm" (click)="addNewAddress()">
              <span class="btn-icon">+</span>
              Yeni Adres Ekle
            </button>
          </div>
          
          <div class="address-list">
            <div *ngFor="let address of addresses; let i = index" class="address-card">
              <div class="address-header">
                <div class="address-title">
                  <h4>{{address.title}}</h4>
                  <span *ngIf="address.isDefault" class="default-badge">VarsayÄ±lan</span>
                </div>
                <div class="address-actions">
                  <button class="btn-icon" (click)="editAddress(address)">
                    âœï¸
                  </button>
                  <button class="btn-icon" (click)="deleteAddress(address)">
                    ğŸ—‘ï¸
                  </button>
                </div>
              </div>
              
              <div class="address-content">
                <p class="address-text">{{address.fullName}}</p>
                <p class="address-text">{{address.address}}</p>
                <p class="address-text">{{address.district}} / {{address.city}}</p>
                <p class="address-text">ğŸ“ {{address.phone}}</p>
              </div>
              
              <div class="address-footer">
                <button
                  class="btn btn-outline btn-sm"
                  (click)="setDefaultAddress(address)"
                  [disabled]="address.isDefault">
                  VarsayÄ±lan Yap
                </button>
              </div>
            </div>
            
            <!-- Empty State -->
            <div *ngIf="addresses.length === 0" class="empty-address">
              <div class="empty-icon">ğŸ“</div>
              <h4>HenÃ¼z adres eklemediniz</h4>
              <p>BaÄŸÄ±ÅŸ almak veya gÃ¶ndermek iÃ§in bir adres ekleyin</p>
              <button class="btn btn-primary" (click)="addNewAddress()">
                Ä°lk Adresi Ekle
              </button>
            </div>
          </div>
          
          <!-- Address Form Modal -->
          <div *ngIf="showAddressForm" class="modal-overlay" (click)="closeAddressForm()">
            <div class="modal-content" (click)="$event.stopPropagation()">
              <div class="modal-header">
                <h3>{{editingAddress ? 'Adresi DÃ¼zenle' : 'Yeni Adres Ekle'}}</h3>
                <button class="modal-close" (click)="closeAddressForm()">Ã—</button>
              </div>
              
              <form (ngSubmit)="saveAddress()" #addressForm="ngForm" class="modal-form">
                <div class="form-group">
                  <label for="addressTitle" class="form-label">Adres BaÅŸlÄ±ÄŸÄ± *</label>
                  <input
                    type="text"
                    id="addressTitle"
                    class="form-control"
                    [(ngModel)]="addressFormData.title"
                    name="title"
                    placeholder="Ã–rn: Ev Adresim, Ä°ÅŸ Adresim"
                    required>
                </div>
                
                <div class="form-group">
                  <label for="fullName" class="form-label">Ad Soyad *</label>
                  <input
                    type="text"
                    id="fullName"
                    class="form-control"
                    [(ngModel)]="addressFormData.fullName"
                    name="fullName"
                    required>
                </div>
                
                <div class="form-grid">
                  <div class="form-group">
                    <label for="addressCity" class="form-label">Åehir *</label>
                    <select
                      id="addressCity"
                      class="form-control"
                      [(ngModel)]="addressFormData.city"
                      name="city"
                      required>
                      <option value="">Åehir seÃ§in</option>
                      <option *ngFor="let city of cities" [value]="city">
                        {{city}}
                      </option>
                    </select>
                  </div>
                  
                  <div class="form-group">
                    <label for="district" class="form-label">Ä°lÃ§e *</label>
                    <input
                      type="text"
                      id="district"
                      class="form-control"
                      [(ngModel)]="addressFormData.district"
                      name="district"
                      required>
                  </div>
                </div>
                
                <div class="form-group">
                  <label for="address" class="form-label">Adres *</label>
                  <textarea
                    id="address"
                    class="form-control"
                    rows="3"
                    [(ngModel)]="addressFormData.address"
                    name="address"
                    placeholder="Cadde, sokak, apartman, daire no..."
                    required></textarea>
                </div>
                
                <div class="form-group">
                  <label for="addressPhone" class="form-label">Telefon *</label>
                  <input
                    type="tel"
                    id="addressPhone"
                    class="form-control"
                    [(ngModel)]="addressFormData.phone"
                    name="phone"
                    placeholder="05XX XXX XX XX"
                    required>
                </div>
                
                <div class="form-group">
                  <label class="checkbox">
                    <input
                      type="checkbox"
                      [(ngModel)]="addressFormData.isDefault"
                      name="isDefault">
                    <span>Bu adresi varsayÄ±lan adresim yap</span>
                  </label>
                </div>
                
                <div class="form-actions">
                  <button
                    type="button"
                    class="btn btn-outline"
                    (click)="closeAddressForm()">
                    Ä°ptal
                  </button>
                  <button
                    type="submit"
                    class="btn btn-primary"
                    [disabled]="isSavingAddress || !addressForm.form.valid">
                    <span *ngIf="!isSavingAddress">Adresi Kaydet</span>
                    <span *ngIf="isSavingAddress">Kaydediliyor...</span>
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>

        <!-- Security Tab -->
        <div *ngIf="activeTab === 'security'" class="tab-pane">
          <div class="security-sections">
            <!-- Change Password -->
            <div class="security-card">
              <h3>ğŸ”’ Åifre DeÄŸiÅŸtir</h3>
              <form (ngSubmit)="changePassword()" #passwordForm="ngForm">
                <div class="form-group">
                  <label for="currentPassword" class="form-label">Mevcut Åifre *</label>
                  <input
                    [type]="showCurrentPassword ? 'text' : 'password'"
                    id="currentPassword"
                    class="form-control"
                    [(ngModel)]="passwordData.currentPassword"
                    name="currentPassword"
                    required>
                  <button type="button" class="password-toggle" (click)="togglePassword('current')">
                    {{showCurrentPassword ? 'ğŸ™ˆ' : 'ğŸ‘ï¸'}}
                  </button>
                </div>
                
                <div class="form-group">
                  <label for="newPassword" class="form-label">Yeni Åifre *</label>
                  <input
                    [type]="showNewPassword ? 'text' : 'password'"
                    id="newPassword"
                    class="form-control"
                    [(ngModel)]="passwordData.newPassword"
                    name="newPassword"
                    required
                    minlength="6">
                  <div class="password-hint">En az 6 karakter</div>
                  <button type="button" class="password-toggle" (click)="togglePassword('new')">
                    {{showNewPassword ? 'ğŸ™ˆ' : 'ğŸ‘ï¸'}}
                  </button>
                </div>
                
                <div class="form-group">
                  <label for="confirmPassword" class="form-label">Yeni Åifre Tekrar *</label>
                  <input
                    [type]="showConfirmPassword ? 'text' : 'password'"
                    id="confirmPassword"
                    class="form-control"
                    [(ngModel)]="passwordData.confirmPassword"
                    name="confirmPassword"
                    required>
                  <button type="button" class="password-toggle" (click)="togglePassword('confirm')">
                    {{showConfirmPassword ? 'ğŸ™ˆ' : 'ğŸ‘ï¸'}}
                  </button>
                </div>
                
                <div class="form-actions">
                  <button
                    type="submit"
                    class="btn btn-primary"
                    [disabled]="isChangingPassword || passwordData.newPassword !== passwordData.confirmPassword">
                    <span *ngIf="!isChangingPassword">Åifreyi DeÄŸiÅŸtir</span>
                    <span *ngIf="isChangingPassword">DeÄŸiÅŸtiriliyor...</span>
                  </button>
                </div>
              </form>
            </div>

            <!-- Two-Factor Authentication -->
            <div class="security-card">
              <h3>ğŸ” Ä°ki FaktÃ¶rlÃ¼ DoÄŸrulama</h3>
              <div class="security-toggle">
                <div class="toggle-info">
                  <h4>SMS DoÄŸrulama</h4>
                  <p>GiriÅŸlerde SMS ile doÄŸrulama kodu alÄ±n</p>
                </div>
                <div class="toggle-switch">
                  <input type="checkbox" id="twoFactor" [(ngModel)]="securitySettings.twoFactorEnabled">
                  <label for="twoFactor" class="toggle-slider"></label>
                </div>
              </div>
              
              <div class="security-toggle">
                <div class="toggle-info">
                  <h4>E-posta Bildirimleri</h4>
                  <p>ÅÃ¼pheli giriÅŸ denemelerinden haberdar olun</p>
                </div>
                <div class="toggle-switch">
                  <input type="checkbox" id="emailAlerts" [(ngModel)]="securitySettings.emailAlerts" checked>
                  <label for="emailAlerts" class="toggle-slider"></label>
                </div>
              </div>
              
              <button class="btn btn-outline" (click)="saveSecuritySettings()">
                GÃ¼venlik AyarlarÄ±nÄ± Kaydet
              </button>
            </div>

            <!-- Active Sessions -->
            <div class="security-card">
              <h3>ğŸŒ Aktif Oturumlar</h3>
              <div class="sessions-list">
                <div *ngFor="let session of activeSessions" class="session-item">
                  <div class="session-info">
                    <div class="session-device">
                      <span class="device-icon">{{session.deviceIcon}}</span>
                      <div>
                        <strong>{{session.device}}</strong>
                        <small>{{session.browser}}</small>
                      </div>
                    </div>
                    <div class="session-details">
                      <span class="session-location">{{session.location}}</span>
                      <span class="session-time">{{session.lastActive}}</span>
                    </div>
                  </div>
                  <button
                    class="btn btn-sm btn-outline"
                    (click)="endSession(session)"
                    [disabled]="session.isCurrent">
                    {{session.isCurrent ? 'Bu Cihaz' : 'SonlandÄ±r'}}
                  </button>
                </div>
              </div>
              
              <button class="btn btn-danger" (click)="endAllSessions()">
                ğŸš« TÃ¼m OturumlarÄ± SonlandÄ±r
              </button>
            </div>
          </div>
        </div>

        <!-- Preferences Tab -->
        <div *ngIf="activeTab === 'preferences'" class="tab-pane">
          <div class="preferences-grid">
            <!-- Notification Preferences -->
            <div class="preferences-card">
              <h3>ğŸ”” Bildirim Tercihleri</h3>
              <div class="preferences-list">
                <div class="preference-item">
                  <div class="preference-info">
                    <h4>Yeni Mesajlar</h4>
                    <p>BaÄŸÄ±ÅŸÃ§Ä±/alÄ±cÄ±lardan gelen mesajlar</p>
                  </div>
                  <div class="toggle-switch small">
                    <input type="checkbox" id="notif1" [(ngModel)]="preferences.newMessages" checked>
                    <label for="notif1" class="toggle-slider"></label>
                  </div>
                </div>
                
                <div class="preference-item">
                  <div class="preference-info">
                    <h4>BaÄŸÄ±ÅŸ Durumu</h4>
                    <p>BaÄŸÄ±ÅŸlarÄ±nÄ±zÄ±n onay/red/kargo durumu</p>
                  </div>
                  <div class="toggle-switch small">
                    <input type="checkbox" id="notif2" [(ngModel)]="preferences.donationStatus" checked>
                    <label for="notif2" class="toggle-slider"></label>
                  </div>
                </div>
                
                <div class="preference-item">
                  <div class="preference-info">
                    <h4>Platform DuyurularÄ±</h4>
                    <p>Ã–nemli gÃ¼ncellemeler ve duyurular</p>
                  </div>
                  <div class="toggle-switch small">
                    <input type="checkbox" id="notif3" [(ngModel)]="preferences.platformAnnouncements">
                    <label for="notif3" class="toggle-slider"></label>
                  </div>
                </div>
                
                <div class="preference-item">
                  <div class="preference-info">
                    <h4>HaftalÄ±k Rapor</h4>
                    <p>HaftalÄ±k aktivite Ã¶zeti e-postasÄ±</p>
                  </div>
                  <div class="toggle-switch small">
                    <input type="checkbox" id="notif4" [(ngModel)]="preferences.weeklyReport">
                    <label for="notif4" class="toggle-slider"></label>
                  </div>
                </div>
              </div>
            </div>

            <!-- Privacy Settings -->
            <div class="preferences-card">
              <h3>ğŸ›¡ï¸ Gizlilik AyarlarÄ±</h3>
              <div class="preferences-list">
                <div class="preference-item">
                  <div class="preference-info">
                    <h4>Profil GÃ¶rÃ¼nÃ¼rlÃ¼ÄŸÃ¼</h4>
                    <p>Profilinizi diÄŸer kullanÄ±cÄ±lara gÃ¶ster</p>
                  </div>
                  <div class="toggle-switch small">
                    <input type="checkbox" id="privacy1" [(ngModel)]="privacySettings.profileVisible" checked>
                    <label for="privacy1" class="toggle-slider"></label>
                  </div>
                </div>
                
                <div class="preference-item">
                  <div class="preference-info">
                    <h4>BaÄŸÄ±ÅŸ GeÃ§miÅŸi</h4>
                    <p>BaÄŸÄ±ÅŸ geÃ§miÅŸinizi herkese aÃ§Ä±k gÃ¶ster</p>
                  </div>
                  <div class="toggle-switch small">
                    <input type="checkbox" id="privacy2" [(ngModel)]="privacySettings.donationHistoryPublic">
                    <label for="privacy2" class="toggle-slider"></label>
                  </div>
                </div>
                
                <div class="preference-item">
                  <div class="preference-info">
                    <h4>Arama MotorlarÄ±</h4>
                    <p>Profilinizi arama motorlarÄ±nda listele</p>
                  </div>
                  <div class="toggle-switch small">
                    <input type="checkbox" id="privacy3" [(ngModel)]="privacySettings.searchEngineIndex">
                    <label for="privacy3" class="toggle-slider"></label>
                  </div>
                </div>
              </div>
              
              <div class="form-group">
                <label for="dataRetention" class="form-label">Veri Saklama Tercihi</label>
                <select
                  id="dataRetention"
                  class="form-control"
                  [(ngModel)]="privacySettings.dataRetention">
                  <option value="30">30 gÃ¼n sonra sil</option>
                  <option value="90">3 ay sonra sil</option>
                  <option value="365">1 yÄ±l sonra sil</option>
                  <option value="forever">Sakla</option>
                </select>
              </div>
            </div>

            <!-- Communication Preferences -->
            <div class="preferences-card">
              <h3>ğŸ’¬ Ä°letiÅŸim Tercihleri</h3>
              <div class="preference-options">
                <div class="radio-group">
                  <label class="radio-option">
                    <input
                      type="radio"
                      name="communication"
                      value="platform"
                      [(ngModel)]="communicationSettings.preferredMethod"
                      checked>
                    <span class="radio-custom"></span>
                    <span class="radio-label">Sadece Platform Ãœzerinden</span>
                  </label>
                  
                  <label class="radio-option">
                    <input
                      type="radio"
                      name="communication"
                      value="phone"
                      [(ngModel)]="communicationSettings.preferredMethod">
                    <span class="radio-custom"></span>
                    <span class="radio-label">Telefon ile</span>
                  </label>
                  
                  <label class="radio-option">
                    <input
                      type="radio"
                      name="communication"
                      value="email"
                      [(ngModel)]="communicationSettings.preferredMethod">
                    <span class="radio-custom"></span>
                    <span class="radio-label">E-posta ile</span>
                  </label>
                </div>
                
                <div class="form-group">
                  <label class="checkbox">
                    <input
                      type="checkbox"
                      [(ngModel)]="communicationSettings.allowMarketing">
                    <span>Platform gÃ¼ncellemeleri ve kampanyalar hakkÄ±nda bilgilendirilmek istiyorum</span>
                  </label>
                </div>
              </div>
            </div>

            <!-- Account Management -->
            <div class="preferences-card danger-zone">
              <h3>âš ï¸ Hesap YÃ¶netimi</h3>
              <div class="danger-actions">
                <button class="btn btn-outline" (click)="exportData()">
                  ğŸ“¥ Verilerimi Ä°ndir
                </button>
                <button class="btn btn-warning" (click)="deactivateAccount()">
                  â¸ï¸ HesabÄ± AskÄ±ya Al
                </button>
                <button class="btn btn-danger" (click)="deleteAccount()">
                  ğŸ—‘ï¸ HesabÄ± Sil
                </button>
              </div>
              <p class="danger-note">
                <strong>Not:</strong> Hesap silme iÅŸlemi geri alÄ±namaz. 
                TÃ¼m baÄŸÄ±ÅŸ geÃ§miÅŸiniz ve verileriniz kalÄ±cÄ± olarak silinecektir.
              </p>
            </div>
          </div>
          
          <div class="preferences-actions">
            <button class="btn btn-outline" (click)="resetPreferences()">
              VarsayÄ±lana DÃ¶n
            </button>
            <button class="btn btn-primary" (click)="saveAllPreferences()">
              TÃ¼m Tercihleri Kaydet
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>